---
title: "Análise de Produção de Eucalyptus grandis"
subtitle: "Atividade 01 - CEN5815"
author: "Nome do Estudante"
date: "29 de agosto de 2025"
format: 
  html:
    theme: bootstrap
    toc: true
    toc-location: left
    code-fold: false
    embed-resources: true
    page-layout: article
    title-block-banner: true
lang: pt-BR
---

# Introdução

Este relatório apresenta a análise estatística de um experimento com **4 blocos casualizados** e **7 procedências** de *Eucalyptus grandis*, conforme solicitado na Atividade 01 da disciplina CEN5815.

## Objetivos

1. Realizar análise descritiva dos dados experimentais
2. Executar ANOVA como Delineamento Inteiramente Casualizado (DIC)
3. Executar ANOVA como Delineamento em Blocos Casualizados (DBC)
4. Comparar a eficácia dos dois delineamentos

## Dados Experimentais

- **Variável resposta**: Produção em m³.ha⁻¹
- **Tratamentos**: 7 procedências (P1 a P7)
- **Blocos**: 4 blocos casualizados
- **Total de parcelas**: 28

# Materiais e Métodos

```{r setup, message=FALSE, warning=FALSE}
# Carregar pacotes necessários
if(!require(tidyverse)) install.packages("tidyverse")
if(!require(knitr)) install.packages("knitr")
if(!require(agricolae)) install.packages("agricolae")

library(tidyverse)
library(knitr)
library(agricolae)

# Fixar semente para reprodutibilidade
set.seed(2025)
```

## Entrada dos Dados

```{r dados}
# Dados conforme tabela da Atividade01.pdf
dados_matriz <- matrix(c(
  358, 284, 273, 284, 258, 249, 318,  # Bloco I
  380, 249, 222, 242, 263, 217, 312,  # Bloco II
  353, 259, 236, 266, 242, 267, 327,  # Bloco III
  360, 242, 226, 252, 231, 220, 319   # Bloco IV
), nrow = 4, byrow = TRUE)

rownames(dados_matriz) <- c("Bloco I", "Bloco II", "Bloco III", "Bloco IV")
colnames(dados_matriz) <- c("P1", "P2", "P3", "P4", "P5", "P6", "P7")

# Mostrar dados originais
kable(dados_matriz, 
      caption = "Tabela 1: Produção em m³.ha⁻¹ por bloco e procedência")

# Converter para formato longo
dados_long <- dados_matriz %>%
  as.data.frame() %>%
  tibble::rownames_to_column("Bloco") %>%
  pivot_longer(cols = -Bloco, names_to = "Procedencia", values_to = "Producao") %>%
  mutate(
    Bloco = factor(Bloco),
    Procedencia = factor(Procedencia, levels = paste0("P", 1:7))
  )
```

# Resultados e Discussão

## Análise Descritiva

```{r descritiva}
# Estatísticas por procedência
estat_proc <- dados_long %>%
  group_by(Procedencia) %>%
  summarise(
    n = n(),
    Media = mean(Producao),
    DP = sd(Producao),
    CV_pct = (sd(Producao)/mean(Producao))*100,
    .groups = "drop"
  )

kable(estat_proc, digits = 2,
      caption = "Tabela 2: Estatísticas descritivas por procedência",
      col.names = c("Procedência", "n", "Média", "Desvio Padrão", "CV (%)"))

# Estatísticas por bloco
estat_bloco <- dados_long %>%
  group_by(Bloco) %>%
  summarise(
    n = n(),
    Media = mean(Producao),
    DP = sd(Producao),
    .groups = "drop"
  )

kable(estat_bloco, digits = 2,
      caption = "Tabela 3: Estatísticas descritivas por bloco")
```

```{r graficos, fig.width=10, fig.height=6}
# Visualização dos dados
p1 <- ggplot(dados_long, aes(x = Procedencia, y = Producao)) +
  geom_boxplot(aes(fill = Procedencia), alpha = 0.7) +
  geom_point(position = position_jitter(width = 0.2), alpha = 0.6) +
  labs(title = "Figura 1: Distribuição da Produção por Procedência",
       x = "Procedência", y = "Produção (m³/ha)") +
  theme_minimal() +
  theme(legend.position = "none")

p2 <- ggplot(dados_long, aes(x = Bloco, y = Producao)) +
  geom_boxplot(aes(fill = Bloco), alpha = 0.7) +
  geom_point(position = position_jitter(width = 0.2), alpha = 0.6) +
  labs(title = "Figura 2: Distribuição da Produção por Bloco",
       x = "Bloco", y = "Produção (m³/ha)") +
  theme_minimal() +
  theme(legend.position = "none")

print(p1)
print(p2)
```

A análise descritiva mostra que a procedência P1 apresentou a maior produção média (`r round(max(estat_proc$Media), 2)` m³/ha), enquanto P3 apresentou a menor (`r round(min(estat_proc$Media), 2)` m³/ha). Os coeficientes de variação indicam boa homogeneidade dentro dos tratamentos.

## ANOVA - Delineamento Inteiramente Casualizado (DIC)

```{r anova-dic}
# ANOVA considerando apenas procedências
modelo_dic <- aov(Producao ~ Procedencia, data = dados_long)
anova_dic <- anova(modelo_dic)

kable(anova_dic, digits = 4,
      caption = "Tabela 4: ANOVA - Delineamento Inteiramente Casualizado")

# Teste de Tukey
tukey_dic <- TukeyHSD(modelo_dic, "Procedencia")
tukey_dic_df <- as.data.frame(tukey_dic$Procedencia) %>%
  tibble::rownames_to_column("Comparacao") %>%
  arrange(`p adj`)

kable(head(tukey_dic_df, 10), digits = 4,
      caption = "Tabela 5: Teste de Tukey - DIC (primeiras 10 comparações)",
      col.names = c("Comparação", "Diferença", "IC Inferior", "IC Superior", "P-valor"))
```

## ANOVA - Delineamento em Blocos Casualizados (DBC)

```{r anova-dbc}
# ANOVA considerando blocos e procedências
modelo_dbc <- aov(Producao ~ Bloco + Procedencia, data = dados_long)
anova_dbc <- anova(modelo_dbc)

kable(anova_dbc, digits = 4,
      caption = "Tabela 6: ANOVA - Delineamento em Blocos Casualizados")

# Teste de Tukey para procedências
tukey_dbc <- TukeyHSD(modelo_dbc, "Procedencia")
tukey_dbc_df <- as.data.frame(tukey_dbc$Procedencia) %>%
  tibble::rownames_to_column("Comparacao") %>%
  arrange(`p adj`)

kable(head(tukey_dbc_df, 10), digits = 4,
      caption = "Tabela 7: Teste de Tukey - DBC (primeiras 10 comparações)",
      col.names = c("Comparação", "Diferença", "IC Inferior", "IC Superior", "P-valor"))

# Grupos homogêneos
if(require(agricolae, quietly = TRUE)) {
  grupos_tukey <- HSD.test(modelo_dbc, "Procedencia", alpha = 0.05)
  kable(grupos_tukey$groups, digits = 2,
        caption = "Tabela 8: Agrupamento das procedências (α = 0,05)")
}
```

## Comparação entre Delineamentos

```{r comparacao}
# Eficiência dos delineamentos
anova_comp <- data.frame(
  Delineamento = c("DIC", "DBC"),
  QM_Residuo = c(anova_dic["Residuals", "Mean Sq"], 
                 anova_dbc["Residuals", "Mean Sq"]),
  F_Tratamentos = c(anova_dic["Procedencia", "F value"], 
                    anova_dbc["Procedencia", "F value"]),
  P_valor = c(anova_dic["Procedencia", "Pr(>F)"], 
              anova_dbc["Procedencia", "Pr(>F)"])
)

kable(anova_comp, digits = 4,
      caption = "Tabela 9: Comparação entre delineamentos DIC e DBC")

# Coeficiente de variação experimental
cv_dic <- sqrt(anova_dic["Residuals", "Mean Sq"]) / mean(dados_long$Producao) * 100
cv_dbc <- sqrt(anova_dbc["Residuals", "Mean Sq"]) / mean(dados_long$Producao) * 100

eficiencia <- anova_dic["Residuals", "Mean Sq"] / anova_dbc["Residuals", "Mean Sq"]
```

A comparação entre os delineamentos mostra que:

- **CV experimental DIC**: `r round(cv_dic, 2)`%
- **CV experimental DBC**: `r round(cv_dbc, 2)`%
- **Eficiência relativa**: `r round(eficiencia, 3)`

O DBC foi mais eficiente, reduzindo o erro experimental e aumentando a precisão da análise.

## Análise de Pressupostos

```{r pressupostos}
# Teste de normalidade dos resíduos
residuos <- residuals(modelo_dbc)
shapiro_test <- shapiro.test(residuos)

cat("Teste de Shapiro-Wilk para normalidade:")
cat("\nW =", round(shapiro_test$statistic, 4))
cat("\nP-valor =", round(shapiro_test$p.value, 4))

# Q-Q plot
ggplot(data.frame(residuos = residuos), aes(sample = residuos)) +
  stat_qq() + stat_qq_line(color = "red") +
  labs(title = "Figura 3: Q-Q Plot dos Resíduos",
       x = "Quantis Teóricos", y = "Quantis Amostrais") +
  theme_minimal()
```

O teste de Shapiro-Wilk (p = `r round(shapiro_test$p.value, 4)`) `r ifelse(shapiro_test$p.value > 0.05, "não rejeita", "rejeita")` a hipótese de normalidade dos resíduos.

# Conclusões

```{r resultados-finais}
p_valor_proc <- anova_dbc["Procedencia", "Pr(>F)"]
p_valor_bloco <- anova_dbc["Bloco", "Pr(>F)"]
melhor_proc <- estat_proc[which.max(estat_proc$Media), "Procedencia"]
```

1. **Diferenças entre procedências**: `r ifelse(p_valor_proc < 0.05, "Significativas", "Não significativas")` (p = `r format(p_valor_proc, scientific = TRUE, digits = 3)`)

2. **Efeito de blocos**: `r ifelse(p_valor_bloco < 0.05, "Significativo", "Não significativo")` (p = `r format(p_valor_bloco, scientific = TRUE, digits = 3)`)

3. **Melhor procedência**: `r melhor_proc` com maior produção média

4. **Eficiência do delineamento**: O DBC foi superior ao DIC, controlando adequadamente a variação entre blocos

5. **Qualidade experimental**: CV de `r round(cv_dbc, 2)`% indica `r ifelse(cv_dbc <= 10, "excelente", ifelse(cv_dbc <= 20, "boa", "regular"))` precisão experimental

**Recomendação**: Para futuros experimentos similares, utilizar o DBC para maior precisão experimental.

# Reprodutibilidade

```{r sessao}
# Informações da sessão
sessionInfo()
```

**Semente utilizada**: 2025

# Referências

- Atividade 01 - CEN5815 (Prof. Dr. Deoclecio Jardim Amorim)
- Montgomery, D. C. (2017). *Design and analysis of experiments*. John Wiley & Sons.
- Pimentel-Gomes, F., & Garcia, C. H. (2002). *Estatística aplicada a experimentos agronômicos e florestais*. FEALQ.
- Documentação do Quarto: https://quarto.org